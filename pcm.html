<input type="file" id="pcm" /><br>
<p id="status"></p>

<script>
"use strict;"

onload = function() {

  document.getElementById("pcm").onchange = function(e) {

    const file = e.target.files[0];
    const reader = new FileReader(file);

    const status = document.getElementById("status");

    status.innerText = "File size" + file.size + "\n\n";

    // Read WAV header
    var start = 0;
    const headerSize = 44;
    var end = start + headerSize;
    reader.readAsArrayBuffer(file.slice(start, end));
    start += headerSize + 2;

    reader.onload = function(e) {

      // Read a block of samples
      reader.onload = function(e) {

        const samples = new Int16Array(e.target.result);

        for (var i = 0; i < samples.length; i += 1) {

          // const s = (samples[i + 1] << 8) & samples[i];
          const s = 0x7fff + ~(samples[i] - 1);
          status.innerText += i + ": " + s + "\n";
        }
      }

      const block = 64;
      end = start + block;
      reader.readAsArrayBuffer(file.slice(start, end));
      start += block;
    }
  }
}
</script>
